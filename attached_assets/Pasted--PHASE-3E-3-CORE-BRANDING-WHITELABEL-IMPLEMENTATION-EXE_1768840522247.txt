
‚úÖ PHASE 3E-3 ‚Äî CORE BRANDING / WHITELABEL

IMPLEMENTATION EXECUTION

‚∏ª

CONTEXT

You are implementing Phase 3E-3: Core Branding / Whitelabel for the WebWaka Modular Rebuild.

This is a CORE SUBSTRATE MODULE.

Repository:
changerplanet/webwaka-core-branding

This module is a TypeScript-only, headless library.

üö´ NO UI
üö´ NO asset hosting
üö´ NO dashboards
üö´ NO React / Next.js / CSS
üö´ NO CDN logic
üö´ NO editors

‚∏ª

CONSTITUTIONAL AUTHORITY

You MUST comply with:
	‚Ä¢	WebWaka Ecosystem Constitution v1.3.1
	‚Ä¢	Phase 3E-2 Core Branding Specification (authoritative)
	‚Ä¢	All Core invariants used in:
	‚Ä¢	Core Ledger
	‚Ä¢	Core Pricing
	‚Ä¢	Core Entitlements
	‚Ä¢	Core Incentives

Branding MUST behave like Entitlements and Incentives:
	‚Ä¢	Hierarchical
	‚Ä¢	Deterministic
	‚Ä¢	Snapshot-based
	‚Ä¢	Offline-safe
	‚Ä¢	Verifiable

‚∏ª

OBJECTIVE

Implement the Core Branding Engine that:
	‚Ä¢	Resolves branding tokens deterministically
	‚Ä¢	Enforces hierarchy precedence
	‚Ä¢	Produces verifiable snapshots
	‚Ä¢	Works offline
	‚Ä¢	Is reusable by any Suite, platform, or future system

‚∏ª

SCOPE (IMPLEMENT EXACTLY)

1Ô∏è‚É£ Domain Models (Zod-validated)

Implement the following models:
	‚Ä¢	BrandingDefinition
	‚Ä¢	BrandingLayer
	‚Ä¢	BrandingContext
	‚Ä¢	ResolvedBranding
	‚Ä¢	BrandingSnapshot

Token categories MUST include:
	‚Ä¢	Primitive Tokens
	‚Ä¢	Semantic Tokens
	‚Ä¢	Brand Tokens
	‚Ä¢	Behavioral Tokens (non-visual)

‚∏ª

2Ô∏è‚É£ Branding Engine

Implement a pure, deterministic engine with the following APIs:

resolveBranding(context, layers)

generateBrandingSnapshot(context, layers)

verifyBrandingSnapshot(snapshot)

resolveFromSnapshot(snapshot, evaluationTime?)

Engine MUST:
	‚Ä¢	Enforce hierarchy strictly
	‚Ä¢	Ignore expired layers
	‚Ä¢	Resolve semantic ‚Üí primitive tokens
	‚Ä¢	Produce canonical output (stable key order)
	‚Ä¢	Hash snapshot using SHA-256
	‚Ä¢	Detect tampering

‚∏ª

3Ô∏è‚É£ Hierarchy Enforcement (LOCKED)

Apply branding in this order (later overrides earlier):
	1.	System defaults
	2.	Partner branding
	3.	Tenant branding
	4.	Suite branding
	5.	Component branding
	6.	Explicit contextual overrides

No exceptions.

‚∏ª

4Ô∏è‚É£ Snapshot Model (MANDATORY)
	‚Ä¢	Canonical JSON
	‚Ä¢	Stable sorting
	‚Ä¢	Deterministic snapshotId
	‚Ä¢	SHA-256 checksum

Snapshots MUST:
	‚Ä¢	Be cacheable
	‚Ä¢	Be verifiable offline
	‚Ä¢	Produce identical results when evaluated live vs snapshot

‚∏ª

5Ô∏è‚É£ Capabilities Registration

Update module.manifest.json to include:

[
  "branding:define",
  "branding:layer.apply",
  "branding:resolve",
  "branding:snapshot.generate",
  "branding:snapshot.verify"
]

Declare dependencies ONLY if strictly required.

‚∏ª

6Ô∏è‚É£ Tests (REQUIRED)

Implement comprehensive tests proving:
	‚Ä¢	Determinism (same input ‚Üí same output, ‚â•10 runs)
	‚Ä¢	Hierarchy precedence enforcement
	‚Ä¢	Time-bound layer expiry handling
	‚Ä¢	Semantic ‚Üí primitive resolution
	‚Ä¢	Snapshot integrity verification
	‚Ä¢	Offline snapshot evaluation equivalence
	‚Ä¢	Tenant isolation (no cross-tenant leakage)

Minimum:
	‚Ä¢	‚â•80% coverage
	‚Ä¢	Explicit Hard Stop proof test

‚∏ª

HARD STOP CONDITION (MUST BE PROVEN BY TEST)

A Suite can request branding with a context and receive a deterministic, verifiable branding snapshot, respecting hierarchy, time bounds, and tenant isolation ‚Äî with no UI code involved.

‚∏ª

EXPLICIT NON-SCOPE (DO NOT IMPLEMENT)

‚ùå Asset uploads
‚ùå Image processing
‚ùå CDN
‚ùå Theme rendering
‚ùå UI components
‚ùå Editors
‚ùå Persistence / DB
‚ùå External APIs

‚∏ª

DELIVERY REQUIREMENTS

When complete, provide:
	1.	Completion Summary
	‚Ä¢	What was implemented
	‚Ä¢	APIs exposed
	‚Ä¢	Invariants enforced
	2.	Test Results
	‚Ä¢	Test count
	‚Ä¢	Coverage %
	3.	Hard Stop Proof
	‚Ä¢	Explicit reference to passing test(s)
	4.	Final Commit SHA

Then:

‚õî STOP
‚õî Await explicit authorization before proceeding to any other phase

‚∏ª

ACKNOWLEDGEMENT FORMAT

Reply first with:

‚ÄúI acknowledge and will implement Phase 3E-3 exactly as specified.‚Äù

Then proceed.